the num of samples is  5000
min 30
max 5000
now we create the bottom level bins, with start value 0, ending value 5002, step 1
[  0   0   0 ...   0   0 134]
now we display the bottom bins histogram
now we create the hierarchy
3
[1, 16, 256]
[array([  0.,   0.,   0., ...,   0.,   0., 134.]), array([0.000e+00, 2.000e+00, 3.940e+02, 1.769e+03, 1.436e+03, 5.470e+02,
       1.830e+02, 1.230e+02, 5.000e+01, 3.000e+01, 1.700e+01, 1.400e+01,
       8.000e+00, 1.000e+01, 1.300e+01, 3.000e+00, 2.000e+00, 6.000e+00,
       3.000e+00, 4.000e+00, 4.000e+00, 2.000e+00, 2.000e+00, 5.000e+00,
       1.000e+00, 2.000e+00, 2.000e+00, 4.000e+00, 2.000e+00, 4.000e+00,
       3.000e+00, 4.000e+00, 3.000e+00, 4.000e+00, 0.000e+00, 1.000e+00,
       0.000e+00, 0.000e+00, 0.000e+00, 4.000e+00, 0.000e+00, 0.000e+00,
       3.000e+00, 1.000e+00, 3.000e+00, 2.000e+00, 0.000e+00, 1.000e+00,
       0.000e+00, 1.000e+00, 2.000e+00, 1.000e+00, 0.000e+00, 0.000e+00,
       1.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 2.000e+00, 0.000e+00,
       0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00,
       0.000e+00, 0.000e+00, 1.000e+00, 2.000e+00, 0.000e+00, 0.000e+00,
       0.000e+00, 1.000e+00, 0.000e+00, 2.000e+00, 0.000e+00, 2.000e+00,
       0.000e+00, 0.000e+00, 0.000e+00, 1.000e+00, 0.000e+00, 3.000e+00,
       0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00,
       1.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00,
       3.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00,
       0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 3.000e+01, 9.000e+00,
       3.000e+00, 0.000e+00, 1.000e+00, 1.000e+00, 0.000e+00, 0.000e+00,
       0.000e+00, 0.000e+00, 0.000e+00, 1.000e+00, 0.000e+00, 0.000e+00,
       0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 1.000e+00,
       1.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00,
       0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00,
       0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 4.000e+00, 1.000e+00,
       0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00,
       0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 1.000e+00, 0.000e+00,
       0.000e+00, 0.000e+00, 1.000e+00, 9.500e+01, 0.000e+00, 1.000e+00,
       0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 2.000e+00, 0.000e+00,
       0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00,
       0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00,
       0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00,
       0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00,
       0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00,
       0.000e+00, 0.000e+00, 0.000e+00, 3.000e+00, 0.000e+00, 0.000e+00,
       0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 2.000e+00,
       2.000e+00, 0.000e+00, 1.000e+00, 5.000e+00, 0.000e+00, 0.000e+00,
       0.000e+00, 0.000e+00, 0.000e+00, 1.000e+00, 0.000e+00, 0.000e+00,
       0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00,
       0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00,
       0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00,
       0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00,
       0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00,
       1.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00,
       0.000e+00, 0.000e+00, 0.000e+00, 3.000e+00, 0.000e+00, 0.000e+00,
       0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 1.000e+00, 0.000e+00,
       0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00,
       0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00,
       0.000e+00, 0.000e+00, 0.000e+00, 1.000e+00, 0.000e+00, 0.000e+00,
       0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00,
       0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00,
       0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00,
       0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00,
       1.340e+02]), array([4.599e+03, 5.000e+01, 2.200e+01, 7.000e+00, 8.000e+00, 5.000e+00,
       4.700e+01, 3.000e+00, 5.000e+00, 9.700e+01, 3.000e+00, 0.000e+00,
       3.000e+00, 1.100e+01, 0.000e+00, 1.000e+00, 4.000e+00, 1.000e+00,
       0.000e+00, 1.340e+02])]
noisy: [array([  1.01387223,   3.31275787,   0.86410949, ...,  -1.22245223,
        -3.22274155, 140.05841764]), array([ 3.17027061e+00,  2.57045024e+00,  4.00561183e+02,  1.77343663e+03,
        1.43413431e+03,  5.46538829e+02,  1.77137982e+02,  1.22505972e+02,
        4.67668358e+01,  3.58018642e+01,  1.77752205e+01,  1.79774884e+01,
        8.37339648e+00,  9.92900469e+00,  2.36261898e+01,  4.94001037e+00,
        3.52110035e+00, -2.19278317e+00,  4.43820180e+00,  8.01100099e+00,
        2.10523844e+00, -9.07942629e+00,  5.23894100e+00,  4.17921556e+00,
        3.76541068e+00,  3.66093731e+00,  6.60502363e+00,  2.93532910e+00,
       -2.08283375e+00,  3.20186495e+00,  5.71714514e+00, -8.90550500e-03,
        7.63648807e+00,  1.87141468e+00, -3.32797100e+00, -1.48620377e+00,
       -1.04729695e+00,  4.26101585e+00,  3.99555271e+00,  4.37748855e+00,
       -5.75336757e-01, -1.11337813e+00,  7.38572502e+00, -5.09381852e+00,
        2.80259147e+00,  1.16940745e+01, -3.32892204e-01,  8.32204939e+00,
        4.50243377e-01,  5.73380623e+00,  3.07669801e+00,  1.28232094e+00,
       -1.15801582e+00,  3.91660907e+00, -2.87642152e-01,  5.89181873e+00,
       -2.62086808e+00,  2.26043337e-01,  2.26259092e+00, -1.95745911e+00,
       -6.27597951e-01, -3.09254842e-01,  4.57601321e+00,  3.50736763e+00,
       -6.89704978e+00, -4.49078600e-01,  3.15054788e+00,  8.70127192e+00,
        1.67875579e+00,  8.15457666e-01, -5.20236802e+00,  5.38471111e+00,
       -2.91698962e+00,  3.04455171e+00, -6.73381464e+00, -1.00434280e+00,
       -1.50977161e+00,  5.70156653e+00, -2.21213008e+00,  4.18164304e+00,
       -1.05421581e+00,  6.02307362e+00,  3.77841355e-01,  2.86294578e+00,
        9.39882437e-01,  3.50694608e+00, -4.29393517e+00,  4.75354049e+00,
        2.30640928e-01,  2.73167627e+00,  9.93635593e+00, -6.10032771e-01,
        7.39984079e+00,  6.20735202e-01,  2.45094152e+00, -1.56664056e+00,
       -2.15727538e+00,  3.09852851e+00, -5.87003354e-01,  2.37830917e-01,
       -1.61937793e+00,  1.01511804e+01, -3.45874403e+00,  3.90013996e+00,
        5.11225481e+00,  1.22083156e+00,  2.60583959e+01,  1.85904440e+01,
        3.34916688e+00, -4.28604509e+00,  6.49735462e-01,  6.38166631e+00,
        1.53433347e+00, -3.31818816e-01, -2.86672428e+00,  3.42195456e+00,
        7.38081925e-01,  4.45361260e+00,  1.27697589e+01,  4.58505289e+00,
       -4.74478382e+00, -1.47425984e+00, -3.99748779e+00,  2.33673276e-01,
       -9.49857560e-02,  4.13649310e+00,  4.83492838e-01, -3.33405803e-01,
        1.90596684e-01, -1.21631553e+00, -1.45599915e+00,  8.30613856e-01,
        1.28676999e+00, -1.46011224e+00,  6.32168692e-01, -1.87905928e+00,
        2.52475300e+00,  2.04918386e+00, -4.01968156e-01, -4.64681070e+00,
        3.03539744e+00, -3.59467192e+00,  1.22586282e+01,  1.17367452e+01,
        3.97910695e+00, -2.16523723e+00,  8.99447400e-01,  1.39508369e+00,
        1.41414865e+00,  4.48145771e+00,  2.39000128e+00,  4.25658142e+00,
       -1.08887473e+01,  1.28445239e+00,  3.56588757e+00, -1.01551336e+00,
       -2.88966048e-01, -7.85339238e+00,  5.69451018e+00,  9.13199840e+01,
       -2.97629887e+00,  1.05405912e+00, -1.13762233e+00,  3.45184541e+00,
       -1.61379033e+00, -2.45209635e-01,  2.24095312e+00, -1.11340138e+00,
        9.74516993e+00,  1.57610393e+00,  1.91716769e+00,  4.20580936e+00,
        1.39587132e+00,  1.49896377e+00,  8.47016528e-01, -1.55553547e+00,
        1.82901669e+00, -8.18021603e+00,  2.08269788e+00, -3.72157066e+00,
       -1.07436166e+00,  4.42508333e+00,  3.51491980e+00, -1.59997347e+00,
       -5.09698012e-02,  3.77064009e+00,  5.11265351e+00,  1.09983344e+00,
        4.36134776e+00,  4.20324113e+00,  1.02428463e+00, -3.28063609e+00,
        1.38097867e+00, -1.25142153e+00, -2.70168303e-01,  6.31932131e-01,
        5.46706678e-01,  1.23884871e+01, -4.87444879e-01, -1.06605519e+00,
       -1.46247219e+00,  1.50549022e+00,  5.05523238e+00,  4.49387930e-01,
        5.58216471e-01,  5.54468461e-01, -4.45913152e+00, -2.29798868e+00,
        2.02374971e+00,  6.68503134e+00,  1.78355934e+00, -3.88191195e+00,
       -1.94010540e+00,  1.28405115e+00, -3.41935494e+00,  2.95251328e+00,
       -9.81999688e-01,  8.01367066e-01, -2.51054600e+00, -1.40810663e-01,
       -3.48413685e-01,  5.33673908e+00, -7.30537297e-01,  4.50882955e+00,
       -3.16517771e+00, -2.56899447e+00, -2.08152320e-01,  2.18779749e+00,
        2.14377128e+00, -5.79041450e+00,  4.47601623e+00, -4.12325374e+00,
       -3.81398915e+00,  1.16918141e+01,  4.75065834e+00, -2.37468962e+00,
       -3.18016586e+00, -1.07358608e+00, -7.74007188e+00, -1.57802432e+00,
        3.96791925e+00,  2.62054846e+00,  2.53281310e+00, -2.72493804e+00,
        3.28587053e-01, -7.89519259e-03,  3.59376752e+00,  8.66791558e-01,
        1.81292871e+00,  1.38571473e+01, -3.25864710e+00,  6.56789479e-01,
       -2.26867819e+00, -2.02442242e+00,  3.52450751e+00, -6.54012165e-01,
       -8.19952155e-01,  7.39105104e-01,  1.46378438e+01, -1.30374881e+00,
       -1.10003054e+00,  3.21757511e+00,  3.26025403e-01, -8.94108864e+00,
        2.95909747e+00,  3.72835260e+00, -7.91115507e+00, -1.08324860e+00,
        1.69249714e+00, -2.55878028e-01, -6.77296440e-01, -5.80256288e-01,
        2.79985596e+00, -5.20640035e-01,  4.46114071e+00, -7.45781702e+00,
        2.38548131e+00,  1.51973539e+00, -5.75861129e-02, -5.79943629e-01,
       -1.58300952e+00,  1.69868795e+00, -7.82979121e-01, -6.88635251e+00,
        2.48674291e+00,  1.00279553e+00,  4.51848486e-01,  3.79087822e+00,
       -1.36731197e+00, -3.27763992e+00, -1.46669908e+01, -4.28783564e+00,
        8.83219396e+00,  4.31462460e+00,  7.27814396e+00,  3.69372386e+00,
       -1.22049387e+00, -7.05939800e+00, -5.23595417e+00, -1.91868847e+00,
       -4.01727415e+00,  6.70490633e+00, -1.12361144e+00, -1.57526101e+00,
        2.25325800e+00,  5.06474604e+00, -8.48914426e-01,  3.37645583e+00,
        5.61038693e+00,  3.67972559e+00,  8.95289104e-01,  8.25270925e-01,
        1.34223224e+02]), array([ 4.59967028e+03,  5.03974781e+01,  2.27623140e+01,  9.77222320e+00,
        9.41511522e+00,  5.63673763e+00,  4.76211515e+01,  5.26802226e-01,
        6.19311745e+00,  9.87670674e+01,  1.61296159e+00, -1.00002873e+01,
        5.51338291e+00,  7.49462975e+00,  5.37085927e+00, -4.88226604e-01,
        7.14693214e+00, -4.95289140e-01, -4.86999560e+00,  1.26164807e+02])]
now we have established the consisted hierarchy with fanout 16
now we run the experiment with range_epsilon: 1.0
now we run the query [1307,1769)
the true count is 50
the hierarchical estimated count is 46.111743
now we run the query [34,2556)
the true count is 4747
the hierarchical estimated count is 4753.535660
now we run the query [2660,3408)
the true count is 10
the hierarchical estimated count is 3.929796
now we run the query [332,466)
the true count is 23
the hierarchical estimated count is 43.138901
now we run the query [125,188)
the true count is 123
the hierarchical estimated count is 135.245936
now we run the query [159,762)
the true count is 137
the hierarchical estimated count is 151.072936
now we run the query [152,2660)
the true count is 323
the hierarchical estimated count is 327.034768
now we run the query [3513,4293)
the true count is 5
the hierarchical estimated count is 24.549249
now we run the query [80,124)
the true count is 836
the hierarchical estimated count is 809.294208
now we run the query [164,2298)
the true count is 203
the hierarchical estimated count is 236.791969
now we run the query [71,314)
the true count is 1736
the hierarchical estimated count is 1727.868748
now we run the query [177,463)
the true count is 86
the hierarchical estimated count is 105.980819
now we run the query [1702,2556)
the true count is 56
the hierarchical estimated count is 51.898162
now we run the query [1769,2026)
the true count is 4
the hierarchical estimated count is 7.582455
now we run the query [246,463)
the true count is 41
the hierarchical estimated count is 25.563638
now we run the query [502,1442)
the true count is 45
the hierarchical estimated count is 71.158245
now we run the query [411,3513)
the true count is 230
the hierarchical estimated count is 205.711182
now we run the query [1551,1721)
the true count is 37
the hierarchical estimated count is 45.162061
now we run the query [1719,3513)
the true count is 132
the hierarchical estimated count is 113.425921
now we run the query [73,126)
the true count is 1378
the hierarchical estimated count is 1349.777911
now we run the query [86,105)
the true count is 420
the hierarchical estimated count is 400.641534
now we run the query [493,3422)
the true count is 214
the hierarchical estimated count is 217.399721
now we run the query [289,492)
the true count is 35
the hierarchical estimated count is 46.180367
now we run the query [164,1707)
the true count is 157
the hierarchical estimated count is 183.535277
now we run the query [157,197)
the true count is 36
the hierarchical estimated count is 37.046422
now we run the query [212,1875)
the true count is 164
the hierarchical estimated count is 188.656555
now we run the query [46,82)
the true count is 3413
the hierarchical estimated count is 3416.299553
now we run the query [376,1725)
the true count is 104
the hierarchical estimated count is 118.384872
now we run the query [416,1243)
the true count is 54
the hierarchical estimated count is 49.184634
now we run the query [65,508)
the true count is 2373
the hierarchical estimated count is 2374.660881
now we run the query [101,4180)
the true count is 629
the hierarchical estimated count is 643.549469
now we run the query [341,3403)
the true count is 235
the hierarchical estimated count is 235.946563
now we run the query [55,163)
the true count is 3486
the hierarchical estimated count is 3442.296163
now we run the query [159,197)
the true count is 32
the hierarchical estimated count is 40.740758
now we run the query [47,433)
the true count is 4293
the hierarchical estimated count is 4294.815715
now we run the query [119,1725)
the true count is 335
the hierarchical estimated count is 363.996956
now we run the query [376,1204)
the true count is 56
the hierarchical estimated count is 66.059959
now we run the query [76,160)
the true count is 1210
the hierarchical estimated count is 1205.620051
now we run the query [3347,3422)
the true count is 9
the hierarchical estimated count is 12.420381
now we run the query [101,458)
the true count is 404
the hierarchical estimated count is 419.153360
now we run the query [37,502)
the true count is 4623
the hierarchical estimated count is 4629.555019
now we run the query [99,1110)
the true count is 479
the hierarchical estimated count is 493.542888
now we run the query [163,1110)
the true count is 139
the hierarchical estimated count is 176.404424
now we run the query [144,439)
the true count is 129
the hierarchical estimated count is 150.372550
now we run the query [3366,3408)
the true count is 3
the hierarchical estimated count is -6.643997
now we run the query [41,1307)
the true count is 4579
the hierarchical estimated count is 4589.989881
now we run the query [341,1726)
the true count is 114
the hierarchical estimated count is 125.294247
now we run the query [478,538)
the true count is 13
the hierarchical estimated count is 3.616891
now we run the query [79,502)
the true count is 1098
the hierarchical estimated count is 1098.915828
now we run the query [718,723)
the true count is 2
the hierarchical estimated count is 6.634473
now we run the query [1726,2552)
the true count is 16
the hierarchical estimated count is 22.586445
now we run the query [60,163)
the true count is 2808
the hierarchical estimated count is 2766.915189
now we run the query [143,678)
the true count is 158
the hierarchical estimated count is 152.788372
now we run the query [64,215)
the true count is 2412
the hierarchical estimated count is 2384.519290
now we run the query [53,3218)
the true count is 4059
the hierarchical estimated count is 4061.249583
now we run the query [272,2026)
the true count is 139
the hierarchical estimated count is 140.370532
now we run the query [131,137)
the true count is 17
the hierarchical estimated count is 16.259394
now we run the query [45,313)
the true count is 4353
the hierarchical estimated count is 4359.241902
now we run the query [376,458)
the true count is 10
the hierarchical estimated count is 20.387825
now we run the query [119,224)
the true count is 188
the hierarchical estimated count is 194.932432
now we run the query [1722,1734)
the true count is 5
the hierarchical estimated count is 9.503655
now we run the query [512,1091)
the true count is 29
the hierarchical estimated count is 45.412258
now we run the query [3347,3408)
the true count is 5
the hierarchical estimated count is 5.929227
now we run the query [188,723)
the true count is 105
the hierarchical estimated count is 116.820126
now we run the query [1247,2591)
the true count is 158
the hierarchical estimated count is 155.988043
now we run the query [104,1110)
the true count is 419
the hierarchical estimated count is 428.569588
now we run the query [112,2298)
the true count is 414
the hierarchical estimated count is 425.236226
now we run the query [335,522)
the true count is 35
the hierarchical estimated count is 32.818698
now we run the query [702,4569)
the true count is 201
the hierarchical estimated count is 217.180637
now we run the query [878,2026)
the true count is 65
the hierarchical estimated count is 77.310478
now we run the query [37,111)
the true count is 4298
the hierarchical estimated count is 4289.633880
now we run the query [443,826)
the true count is 40
the hierarchical estimated count is 44.218058
now we run the query [762,2556)
the true count is 80
the hierarchical estimated count is 78.520597
now we run the query [247,262)
the true count is 2
the hierarchical estimated count is -29.077712
now we run the query [826,1779)
the true count is 63
the hierarchical estimated count is 55.205929
now we run the query [878,1726)
the true count is 57
the hierarchical estimated count is 73.808837
now we run the query [1177,3403)
the true count is 172
the hierarchical estimated count is 178.397322
now we run the query [411,629)
the true count is 31
the hierarchical estimated count is 15.849965
now we run the query [3422,3513)
the true count is 1
the hierarchical estimated count is -20.558410
now we run the query [108,328)
the true count is 306
the hierarchical estimated count is 312.670271
now we run the query [83,272)
the true count is 855
the hierarchical estimated count is 849.859242
now we run the query [120,177)
the true count is 145
the hierarchical estimated count is 140.211754
now we run the query [87,109)
the true count is 429
the hierarchical estimated count is 397.962157
now we run the query [1204,2015)
the true count is 57
the hierarchical estimated count is 62.960826
now we run the query [135,177)
the true count is 77
the hierarchical estimated count is 71.165162
now we run the query [289,4180)
the true count is 254
the hierarchical estimated count is 267.895966
now we run the query [56,1442)
the true count is 3502
the hierarchical estimated count is 3506.136653
now we run the query [61,72)
the true count is 1113
the hierarchical estimated count is 1107.424078
now we run the query [95,479)
the true count is 516
the hierarchical estimated count is 504.445123
now we run the query [118,139)
the true count is 100
the hierarchical estimated count is 101.468264
now we run the query [163,250)
the true count is 58
the hierarchical estimated count is 92.528356
now we run the query [61,362)
the true count is 2772
the hierarchical estimated count is 2753.917961
now we run the query [36,384)
the true count is 4610
the hierarchical estimated count is 4606.431599
now we run the query [42,118)
the true count is 4245
the hierarchical estimated count is 4237.456058
now we run the query [341,723)
the true count is 50
the hierarchical estimated count is 48.467009
now we run the query [103,627)
the true count is 408
the hierarchical estimated count is 410.072124
now we run the query [723,1875)
the true count is 70
the hierarchical estimated count is 86.257121
now we run the query [69,136)
the true count is 1788
the hierarchical estimated count is 1759.347075
now we run the query [1734,2273)
the true count is 7
the hierarchical estimated count is -16.970437
now we run the query [86,178)
the true count is 698
the hierarchical estimated count is 666.900544
in 100 range queries, the mean absolute err is 12.441767, and the var of err is 105.196306
